!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):t["react-compound-slider"]=e(t.React)}(this,function(t){"use strict";var e="default"in t?t.default:t,n=function(){};var r=n;function o(t){return function(){return t}}var i=function(){};i.thatReturns=o,i.thatReturnsFalse=o(!1),i.thatReturnsTrue=o(!0),i.thatReturnsNull=o(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(t){return t};var a=i;var u=function(t,e,n,r,o,i,a,u){if(!t){var s;if(void 0===e)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,o,i,a,u],l=0;(s=new Error(e.replace(/%s/g,function(){return c[l++]}))).name="Invariant Violation"}throw s.framesToPop=1,s}},s=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable;(function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}})()&&Object.assign;var p,h="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",v=(function(t){t.exports=function(){function t(t,e,n,r,o,i){i!==h&&u(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return n.checkPropTypes=a,n.PropTypes=n,n}()}(p={exports:{}},p.exports),function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.forEach(function(t){return t&&t.apply(void 0,n)})}}),f=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},m=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},y=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},g=function(t){function n(){var e,r;f(this,n);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=r=y(this,t.call.apply(t,[this].concat(i))),r.getRailProps=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.props,n=e.emitMouse,o=e.emitTouch;return d({},t,{onMouseDown:v(t.onMouseDown,n),onTouchStart:v(t.onTouchStart,o)})},y(r,e)}return m(n,t),n.prototype.render=function(){var t=this.getRailProps,n=(0,this.props.children)({getRailProps:t});return n&&e.Children.only(n)},n}(t.Component),T=function(t){function n(){return f(this,n),y(this,t.apply(this,arguments))}return m(n,t),n.prototype.render=function(){var t=this.props,n=t.children,r=t.values,o=t.scale,i=t.count,a=t.emitMouse,u=t.emitTouch,s=n({ticks:(r||o.getTicks(i)).map(function(t){return{id:"$$-"+t,value:t,percent:o.getValue(t)}}),emitMouse:a,emitTouch:u});return s&&e.Children.only(s)},n}(t.Component);T.defaultProps={count:10};var M=function(t){function n(){var e,r;f(this,n);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=r=y(this,t.call.apply(t,[this].concat(i))),r.getTrackProps=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.props,n=e.emitMouse,o=e.emitTouch;return d({},t,{onMouseDown:v(t.onMouseDown,n),onTouchStart:v(t.onTouchStart,o)})},y(r,e)}return m(n,t),n.prototype.render=function(){for(var t=this.getTrackProps,n=this.props,r=n.children,o=n.left,i=n.right,a=n.scale,u=n.handles,s=a.getDomain(),c=[],l=0;l<u.length+1;l++){var p=u[l-1],h=u[l];0===l&&!0===o?p={id:"$",value:s[0],percent:0}:l===u.length&&!0===i&&(h={id:"$",value:s[1],percent:100}),p&&h&&c.push({id:p.id+"-"+h.id,source:p,target:h})}var v=r({tracks:c,getTrackProps:t});return v&&e.Children.only(v)},n}(t.Component);M.defaultProps={left:!0,right:!0};var b=function(t){function n(){var e,r;f(this,n);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=r=y(this,t.call.apply(t,[this].concat(i))),r.getHandleProps=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.props,o=n.emitMouse,i=n.emitTouch;return d({},e,{onMouseDown:v(e.onMouseDown,function(e){return o(e,t)}),onTouchStart:v(e.onTouchStart,function(e){return i(e,t)})})},y(r,e)}return m(n,t),n.prototype.render=function(){var t=this.getHandleProps,n=this.props,r=(0,n.children)({handles:n.handles,getHandleProps:t});return r&&e.Children.only(r)},n}(t.Component);function S(t){return function(e,n){return e.val>n.val?t?-1:1:n.val>e.val?t?1:-1:0}}function w(t,e,n,r){var o=t.findIndex(function(t){return t.key===e});if(-1!==o){var i=t[o],a=i.key;return i.val===n?t:[].concat(t.slice(0,o),[{key:a,val:n}],t.slice(o+1)).sort(S(r))}return t}function E(t,e){if(!t)return[0,0];var n=t.getBoundingClientRect();return e?[n.top,n.bottom]:[n.left,n.right]}function k(t,e,n){for(var r,o=(r=(""+n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(r[1]?r[1].length:0)-(r[2]?+r[2]:0)):0,i=+t.toFixed(o),a=+e.toFixed(o),u=[],s=i;s<=a;)u.push(s),s=+(s+n).toFixed(o);return u}function P(t){var e=t.type,n=void 0===e?"":e,r=t.touches;return!r||r.length>1||"touchend"===n.toLowerCase()&&r.length>0}function x(t,e){return t?e.touches[0].clientY:e.touches[0].pageX}function O(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var R=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return O(e(t),n)}),{left:function(e,n,r,o){for(null==r&&(r=0),null==o&&(o=e.length);r<o;){var i=r+o>>>1;t(e[i],n)<0?r=i+1:o=i}return r},right:function(e,n,r,o){for(null==r&&(r=0),null==o&&(o=e.length);r<o;){var i=r+o>>>1;t(e[i],n)>0?o=i:r=i+1}return r}}}(O).right,C=Math.sqrt(50),D=Math.sqrt(10),V=Math.sqrt(2);function j(t,e,n){var r,o,i,a,u=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(o=t,t=e,e=o),0===(a=function(t,e,n){var r=(e-t)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,o);return o>=0?(i>=C?10:i>=D?5:i>=V?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(i>=C?10:i>=D?5:i>=V?2:1)}(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),i=new Array(o=Math.ceil(e-t+1));++u<o;)i[u]=(t+u)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),i=new Array(o=Math.ceil(t-e+1));++u<o;)i[u]=(t-u)/a;return r&&i.reverse(),i}var L=function(){function t(){f(this,t),this.domain=[0,1],this.range=[0,1],this.interpolator=null}return t.prototype.createInterpolator=function(t,e){var n=t[0],r=t[1],o=e[0],i=e[1];return r<n?(n=this.deinterpolateValue(r,n),o=this.interpolateValue(i,o)):(n=this.deinterpolateValue(n,r),o=this.interpolateValue(o,i)),function(t){return o(n(t))}},t.prototype.interpolateValue=function(t,e){return e-=t=+t,function(n){return t+e*n}},t.prototype.deinterpolateValue=function(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(){return e}},t.prototype.rescale=function(){return this.interpolator=null,this},t.prototype.getValue=function(t){var e=this.domain,n=this.range;return(this.interpolator||(this.interpolator=this.createInterpolator(e,n)))(+t)},t.prototype.setDomain=function(t){return this.domain=t.map(function(t){return+t}),this.rescale(),this},t.prototype.getDomain=function(){return this.domain},t.prototype.setRange=function(t){return this.range=t.map(function(t){return+t}),this},t.prototype.getTicks=function(t){var e=this.domain;return j(e[0],e[e.length-1],t||10)},t}(),U=function(){function t(){var e=this;f(this,t),this.getValue=function(t){var n=e.range,r=e.domain,o=e.n;return n[R(r,t,0,o)]},this.setDomain=function(t){return e.x0=+t[0],e.x1=+t[1],e.rescale(),e},this.setRange=function(t){return e.range=t.slice(),e.n=e.range.length-1,e},this.x0=0,this.x1=1,this.domain=[.5],this.range=[0,1],this.n=1}return t.prototype.rescale=function(){var t=this.x0,e=this.x1,n=this.n,r=-1;for(this.domain=new Array(n);++r<n;)this.domain[r]=((r+1)*e-(r-n)*t)/(n+1)},t}(),A="react-compound-slider:",_="undefined"!=typeof window&&"undefined"!=typeof document,I=function(){},N=function(t){function n(e){f(this,n);var r=y(this,t.call(this,e));return r.state={values:[]},r.slider=null,r.valueToPerc=new L,r.valueToStep=new U,r.pixelToStep=new U,r.onMouseMove=r.onMouseMove.bind(r),r.onTouchMove=r.onTouchMove.bind(r),r.submitUpdate=r.submitUpdate.bind(r),r.onMouseDown=r.onMouseDown.bind(r),r.onTouchStart=r.onTouchStart.bind(r),r.onStart=r.onStart.bind(r),r.onMouseUp=r.onMouseUp.bind(r),r.onTouchEnd=r.onTouchEnd.bind(r),r}return m(n,t),n.prototype.componentWillMount=function(){var t=this.props,e=t.values,n=t.domain,r=t.step,o=t.reversed;this.updateRange(n,r,o),this.setValues(e,o)},n.prototype.componentWillReceiveProps=function(t){var e,n,r=t.domain,o=t.step,i=t.reversed,a=t.values,u=this.props;if(r[0]!==u.domain[0]||r[1]!==u.domain[1]||o!==u.step||i!==u.reversed){this.updateRange(r,o,i);var s=this.reMapValues(i);void 0!==a&&a!==u.values||(t.onChange(s),t.onUpdate(s))}e=a,n=u.values,e===n||e.length===n.length&&e.reduce(function(t){return function(e,n,r){return e&&t[r]===n}}(n),!0)||this.setValues(a,i)},n.prototype.componentWillUnmount=function(){this.removeListeners()},n.prototype.removeListeners=function(){_&&(document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))},n.prototype.reMapValues=function(t){var e=this.state.values;return this.setValues(e.map(function(t){return t.val}),t)},n.prototype.setValues=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments[1],o=0,i=e.map(function(e){var n=t.valueToStep.getValue(e);return e!==n&&(o+=1,r(!1,A+" Invalid value encountered. Changing "+e+" to "+n+".")),n}).map(function(t,e){return{key:"$$-"+e,val:t}}).sort(S(n)),a=i.map(function(t){return t.val});return o>0&&(this.props.onUpdate(a),this.props.onChange(a)),this.setState(function(){return{values:i}}),a},n.prototype.updateRange=function(t,e,n){var o=t[0],i=t[1],a=k(o,i,e);this.valueToStep.setRange(a).setDomain([o-e/2,i+e/2]),!0===n?(this.valueToPerc.setDomain([o,i]).setRange([100,0]),a.reverse()):this.valueToPerc.setDomain([o,i]).setRange([0,100]),this.pixelToStep.setRange(a),r(i>o,A+" Max must be greater than min (even if reversed). Max is "+i+". Min is "+o+"."),r(a.length<=10001,A+" Increase step value. Found "+a.length.toLocaleString()+" values in range.");var u=a.length-1;r(a[n?u:0]===o&&a[n?0:u]===i,A+" The range is incorrectly calculated. Check domain (min, max) and step values.")},n.prototype.onMouseDown=function(t,e){this.onStart(t,e,!1)},n.prototype.onTouchStart=function(t,e){P(t)||this.onStart(t,e,!0)},n.prototype.onStart=function(t,e,n){var r=this.state.values,o=this.props.onSlideStart;t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),r.find(function(t){return t.key===e})?(this.active=e,o(r.map(function(t){return t.val}),{activeHandleID:e}),n?this.addTouchEvents():this.addMouseEvents()):(this.active=null,this.handleRailAndTrackClicks(t,n))},n.prototype.handleRailAndTrackClicks=function(t,e){var n=this.state.values,r=this.props,o=r.vertical,i=r.reversed,a=this.slider;this.pixelToStep.setDomain(E(a,o));var u=void 0;u=e?this.pixelToStep.getValue(x(o,t)):this.pixelToStep.getValue(o?t.clientY:t.pageX);for(var s=null,c=1/0,l=0;l<n.length;l++){var p=n[l],h=p.key,v=p.val,f=Math.abs(v-u);f<c&&(s=h,c=f)}var d=w(n,s,u,i);this.submitUpdate(d,!0)},n.prototype.addMouseEvents=function(){_&&(document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp))},n.prototype.addTouchEvents=function(){_&&(document.addEventListener("touchmove",this.onTouchMove),document.addEventListener("touchend",this.onTouchEnd))},n.prototype.onMouseMove=function(t){var e=this.state.values,n=this.props,r=n.vertical,o=n.reversed,i=this.active,a=this.slider;this.pixelToStep.setDomain(E(a,r));var u=w(e,i,this.pixelToStep.getValue(r?t.clientY:t.pageX),o);this.submitUpdate(u)},n.prototype.onTouchMove=function(t){var e=this.state.values,n=this.props,r=n.vertical,o=n.reversed,i=this.active,a=this.slider;if(!P(t)){this.pixelToStep.setDomain(E(a,r));var u=w(e,i,this.pixelToStep.getValue(x(r,t)),o);this.submitUpdate(u)}},n.prototype.submitUpdate=function(t,e){var n=this.props,o=n.mode,i=n.step,a=n.onUpdate,u=n.onChange,s=n.reversed,c=this.valueToStep.getValue;this.setState(function(n){var l=n.values,p=void 0;if("function"==typeof o)p=o(l,t,i,s,c),r(Array.isArray(p),"Custom mode function did not return an array.");else switch(o){case 1:p=function(t,e){return e}(0,t);break;case 2:p=function(t,e){for(var n=0;n<t.length;n++){if(t[n].key!==e[n].key)return t;if(e[n+1]&&e[n].val===e[n+1].val)return t}return e}(l,t);break;case 3:p=function t(e,n,r,o,i){for(var a=-1,u=!0,s=0;s<e.length;s++){var c=e[s],l=n[s];if(!l||l.key!==c.key)return e;l.val!==c.val&&(a=s,u=l.val-c.val>0)}if(-1===a)return e;for(var p=u?r:-r,h=0;h<n.length;h++){var v=n[h],f=n[h+1];if(f&&v.val===f.val){if(h===a){var d=f.val+p;if(i(d)===d){var m=t(n,w(n,f.key,f.val+p,o),r,o,i);return m===n?e:m}return e}var y=v.val+p;if(i(y)===y){var g=t(n,w(n,v.key,v.val+p,o),r,o,i);return g===n?e:g}return e}}return n}(l,t,i,s,c);break;default:p=t,r(!1,A+" Invalid mode value.")}return a(p.map(function(t){return t.val})),e&&u(p.map(function(t){return t.val})),{values:p}})},n.prototype.onMouseUp=function(){var t=this.state.values,e=this.props,n=e.onChange,r=e.onSlideEnd,o=this.active;this.active=null,n(t.map(function(t){return t.val})),r(t.map(function(t){return t.val}),{activeHandleID:o}),_&&(document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp))},n.prototype.onTouchEnd=function(){var t=this.state.values,e=this.props,n=e.onChange,r=e.onSlideEnd;this.active=null,n(t.map(function(t){return t.val})),r(t.map(function(t){return t.val})),_&&(document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))},n.prototype.render=function(){var t=this,n=this.state.values,r=this.props,o=r.className,i=r.rootStyle,a=n.map(function(e){var n=e.key,r=e.val;return{id:n,value:r,percent:t.valueToPerc.getValue(r)}}),u=e.Children.map(this.props.children,function(n){return n.type.name===g.name||n.type.name===T.name||n.type.name===M.name||n.type.name===b.name?e.cloneElement(n,{scale:t.valueToPerc,handles:a,emitMouse:t.onMouseDown,emitTouch:t.onTouchStart}):n});return e.createElement("div",{style:i||{},className:o,ref:function(e){return t.slider=e}},u)},n}(t.PureComponent);return N.defaultProps={mode:1,step:.1,domain:[0,100],vertical:!1,reversed:!1,onChange:I,onUpdate:I,onSlideStart:I,onSlideEnd:I},N.Rail=g,N.Ticks=T,N.Tracks=M,N.Handles=b,N});
